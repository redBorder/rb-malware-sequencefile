package net.redborder.malware.sequencefile.util;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;

/**
 * Created by Lito on 16/3/15.
 */
public class S3HDFSDB {
    private static S3HDFSDB s3HDFSDB = null;
    private Map database = null;
    private List<String> analyzingFiles = null;

    private S3HDFSDB (){
        database = new ConcurrentHashMap<>();
        analyzingFiles = new ArrayList<>();
    }

    public static S3HDFSDB getInstance(){
        if(s3HDFSDB==null)
            s3HDFSDB = new S3HDFSDB();
        return s3HDFSDB;
    }

    public void addEntry(String s3Path){
        analyzingFiles.add(s3Path);
    }

    public void addEntry(String seqFile, List<String> s3Paths){
        database.put(seqFile, s3Paths);
        System.out.println("EL MAPA en addEntry ES: KEY: "+seqFile +"VALUE es "+s3Paths);
    }

    public void removeEntry(String seqFile){
        List<String> s3paths = (List<String>) database.remove(seqFile);
        System.out.print("KEY: "+ seqFile + " VALUE: " +s3paths);
        analyzingFiles.removeAll(s3paths);
    }

    public Boolean isAnalyzing(String s3file){
        return analyzingFiles.contains(s3file);
    }

}
