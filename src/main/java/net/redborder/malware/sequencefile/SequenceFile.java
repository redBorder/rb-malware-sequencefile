package net.redborder.malware.sequencefile;

import net.redborder.malware.sequencefile.util.ConfigFile;
import net.redborder.clusterizer.MappedTask;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

/**
 * Created by andresgomez on 3/2/15.
 */
public class SequenceFile extends MappedTask {

    List<String> s3FilesPaths;
    boolean done = false;

    public SequenceFile() {
        super();
        s3FilesPaths = new ArrayList<String>();
    }

    public SequenceFile(Map<? extends String, ? extends Object> m) {
        super(m);
        s3FilesPaths = new ArrayList<String>();
    }

    public static Integer getSequenceFileLenght() {
        return ConfigFile.getInstance().getFromGeneral("sequence_file_length");
    }

    public List<String> getS3FilesPaths() {
        return getData("s3_files");
    }

    public Integer sizeNow() {
        return s3FilesPaths.size();
    }

    public void addS3FilePath(String s3FilePath) {
        s3FilesPaths.add(s3FilePath);
    }

    public void done() {
        done = true;
        saveS3FilesPaths();
    }

    public boolean isDone() {
        return done;
    }

    private void saveS3FilesPaths() {
        setData("s3_files", s3FilesPaths);
    }
}
